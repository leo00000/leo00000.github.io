<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>












    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞 | 
        
        leo00000的个人博客
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="leo00000&#39; blog">
    <meta name="keywords" content="ctf 渗透测试 hacker leo00000,EXP,CVE">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/atelier-dune-dark.min.css?Sq+/jscLQsK3lkqis0e/aA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg.png);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.proxy.ustclug.org/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="leo00000的个人博客">
    <meta name="msapplication-starturl" content="http://leo00000.cn/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="leo00000的个人博客">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://leo00000.cn/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞 | leo00000的个人博客">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="leo00000&#39; blog">
    <meta property="og:article:tag" content="EXP"> <meta property="og:article:tag" content="CVE"> 

    
        <meta property="article:published_time" content="Wed Jul 04 2018 00:00:00 GMT+0800">
        <meta property="article:modified_time" content="Sat Jul 14 2018 20:06:41 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://leo00000.cn/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://leo00000.cn/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/index.html",
    "headline": "漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞",
    "datePublished": "Wed Jul 04 2018 00:00:00 GMT+0800",
    "dateModified": "Sat Jul 14 2018 20:06:41 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "leo00000",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.jpeg"
        },
        "description": "The more quiet you are, the more you hear."
    },
    "publisher": {
        "@type": "Organization",
        "name": "leo00000的个人博客",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",EXP,CVEctf 渗透测试 hacker leo00000",
    "description": "leo00000&#39; blog",
}
</script>


    

    <!-- Analytics -->
    
    
    
        <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1271946750&web_id=1271946750" language="JavaScript"></script>
</div>
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#OLE编程与逆向"><span class="post-toc-number">2.</span> <span class="post-toc-text">OLE编程与逆向</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#OLE编程"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">OLE编程</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#OLE逆向"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">OLE逆向</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#识别初始化过程"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">识别初始化过程</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#识别接口函数"><span class="post-toc-number">2.2.2.</span> <span class="post-toc-text">识别接口函数</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#漏洞分析"><span class="post-toc-number">3.</span> <span class="post-toc-text">漏洞分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#漏洞利用"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">漏洞利用</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Metasploit框架"><span class="post-toc-number">4.</span> <span class="post-toc-text">Metasploit框架</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.jpeg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>leo00000</strong>
        <span>7月 04, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/CVE/">CVE</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/EXP/">EXP</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞&url=http://leo00000.cn/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/index.html&pic=http://leo00000.cn/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=leo00000的个人博客&title=漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞&summary=leo00000&#39; blog&pics=http://leo00000.cn/img/favicon.png&url=http://leo00000.cn/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>CVE-2017-11882是windows OLE应用程序EQNEDT32.exe上的一个漏洞，可以实现远程代码执行。</p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>有关于OLE漏洞最近几年不断的曝光出来，CVE-2012-0158、CVE-2014-4114、CVE-2015-1641、CVE-2015-1641、CVE-2017-11882、CVE-2018-0802等等，盛产CVE而且利用难度不高，影响还是比较大的。Haifei Li(haifei.li@intel.com)和Bing Sun(bing.sun@intel.com)在这方面有两篇很好的文章：<a href="/pdf/us-15-Li-Attacking-Interoperability-An-OLE-Edition.pdf">Attacking Interoperability: ​An OLE Edition</a>和<a href="/pdf/Moniker_Magic_final.pdf">Moniker Magic: Running Scripts Directly in Microsoft Office</a>,看雪上有大佬的<a href="https://bbs.pediy.com/thread-219234.htm" target="_blank" rel="noopener">译文</a>，这里就以CVE-2017-11882为例，在OLE攻击面中分析与利用。</p>
<h3 id="OLE编程与逆向"><a href="#OLE编程与逆向" class="headerlink" title="OLE编程与逆向"></a>OLE编程与逆向</h3><h4 id="OLE编程"><a href="#OLE编程" class="headerlink" title="OLE编程"></a>OLE编程</h4><p>推荐两个资源<a href="https://download.csdn.net/download/yjwffgip456/4632888" target="_blank" rel="noopener">COM编程精彩实例.pdf</a>和<a href="https://blog.csdn.net/wangqiulin123456/article/list/2?t=1" target="_blank" rel="noopener">IT民工的博客</a>。这里说一些大概，更多细节可以从资源中了解到。<br>OLE(Object Linking and Embedding)是COM的一部分，COM由两部分组成，COM客户端和COM服务器，以CVE-2017-11882来说，office中的word进程winword.exe就是COM客户端，嵌入其中的EQNEDT32.exe就是COM服务器。COM服务器有两类，一类是DLL将自己映射到客户端进程空间，叫做进程中服务器；另外一类是EXE有着自己独立的进程空间，服务器和客户端通过LPC进行通信，叫做进程外服务器，也叫本地服务器。CVE-2017-11882中EQNEDT32.exe就是进程外服务器。<br>通过了解进COM程外服务器编程，我们知道OLE服务器的一些特征：</p>
<ol>
<li>会调用CoInitialize()进行COM初始化工作，对于OLE是OleInitialize()函数</li>
<li>OLE中会实现一些特定功能的接口函数，至少包括IUnknown、IPersist、IPersistStorage、IOleObject等。关于更多接口信息参考<a href="https://blog.csdn.net/dotneterbj/article/details/20727173" target="_blank" rel="noopener">链接</a>。对这些接口的初始化工作里OleInitialize()不远。</li>
<li>初始化完成后会调用CoRegisterClassObject将EXE对象注册到表中供其他程序使用。</li>
<li>会调用一些关键函数，如：coml2!CExposedDocFile::OpenStream(), coml2!CExposedStream::Read()</li>
</ol>
<p>关于OLE客户端，如何获取CLSID和数据，在<a href="/pdf/us-15-Li-Attacking-Interoperability-An-OLE-Edition.pdf">An OLE Edition</a>论文中做了很全面的解释。将整个过程简单的表示出来，如下图：<br></p>
<h4 id="OLE逆向"><a href="#OLE逆向" class="headerlink" title="OLE逆向"></a>OLE逆向</h4><p>有了上面的基础，逆向就会相对简单一些。这里的逆向我们主要做的是静态分析工作，动态调试留到漏洞分析去讲。静态分析在IDA中我们主要做两个工作，识别初始化过程和接口函数。</p>
<h5 id="识别初始化过程"><a href="#识别初始化过程" class="headerlink" title="识别初始化过程"></a>识别初始化过程</h5><p>在前面正向编程过程中我们知道一个关键函数OleInitialize()、CoRegisterClassObject()，定位到函数sub_40415B，该函数就是服务器程序的初始化函数了。</p>
<h5 id="识别接口函数"><a href="#识别接口函数" class="headerlink" title="识别接口函数"></a>识别接口函数</h5><p>接口函数的初始化工作应该离OleInitialize函数不会太远，可以肯定在sub_40415B初始化函数中了。通过OleView工具，我们看到了Microsoft Equation3.0注册了9个接口，<br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/oleview.png"><br>其中IclientSecurity和IMultiQI接口是供UWP应用使用的，对与desktop app我们会实现其余的7个接口，对比接口特征然后我们定位到sub_40440A，有很明显的分支结构，有大量的虚函数，我们判定sub_40440A应该是接口函数的初始化函数，然后参照IPersistStorageVtbl定义对比接口数量，IPersistStorage是10个，其中有10个虚函数的分支有两个(loc_404749和loc_4048B4)，继续比较函数功能发现分支loc_404749是用来初始化IPersistStorage接口的，loc_4048B4是用来初始化IOleInPlaceActiveObject接口的。<br>其中IPersistStorageVtbl定义能通过MSDN查到，在Objidl.h中：</p>
<pre><code class="c">EXTERN_C const IID IID_IPersistStorage;

#if defined(__cplusplus) &amp;&amp; !defined(CINTERFACE)

    MIDL_INTERFACE(&quot;0000010a-0000-0000-C000-000000000046&quot;)
    IPersistStorage : public IPersist
    {
    public:
        virtual HRESULT STDMETHODCALLTYPE IsDirty( void) = 0;

        virtual HRESULT STDMETHODCALLTYPE InitNew( 
            /* [unique][in] */ __RPC__in_opt IStorage *pStg) = 0;

        virtual HRESULT STDMETHODCALLTYPE Load( 
            /* [unique][in] */ __RPC__in_opt IStorage *pStg) = 0;

        virtual HRESULT STDMETHODCALLTYPE Save( 
            /* [unique][in] */ __RPC__in_opt IStorage *pStgSave,
            /* [in] */ BOOL fSameAsLoad) = 0;

        virtual HRESULT STDMETHODCALLTYPE SaveCompleted( 
            /* [unique][in] */ __RPC__in_opt IStorage *pStgNew) = 0;

        virtual HRESULT STDMETHODCALLTYPE HandsOffStorage( void) = 0;

    };


#else   /* C style interface */

    typedef struct IPersistStorageVtbl
    {
        BEGIN_INTERFACE

        HRESULT ( STDMETHODCALLTYPE *QueryInterface )( 
            __RPC__in IPersistStorage * This,
            /* [in] */ __RPC__in REFIID riid,
            /* [annotation][iid_is][out] */ 
            _COM_Outptr_  void **ppvObject);

        ULONG ( STDMETHODCALLTYPE *AddRef )( 
            __RPC__in IPersistStorage * This);

        ULONG ( STDMETHODCALLTYPE *Release )( 
            __RPC__in IPersistStorage * This);

        HRESULT ( STDMETHODCALLTYPE *GetClassID )( 
            __RPC__in IPersistStorage * This,
            /* [out] */ __RPC__out CLSID *pClassID);

        HRESULT ( STDMETHODCALLTYPE *IsDirty )( 
            __RPC__in IPersistStorage * This);

        HRESULT ( STDMETHODCALLTYPE *InitNew )( 
            __RPC__in IPersistStorage * This,
            /* [unique][in] */ __RPC__in_opt IStorage *pStg);

        HRESULT ( STDMETHODCALLTYPE *Load )( 
            __RPC__in IPersistStorage * This,
            /* [unique][in] */ __RPC__in_opt IStorage *pStg);

        HRESULT ( STDMETHODCALLTYPE *Save )( 
            __RPC__in IPersistStorage * This,
            /* [unique][in] */ __RPC__in_opt IStorage *pStgSave,
            /* [in] */ BOOL fSameAsLoad);

        HRESULT ( STDMETHODCALLTYPE *SaveCompleted )( 
            __RPC__in IPersistStorage * This,
            /* [unique][in] */ __RPC__in_opt IStorage *pStgNew);

        HRESULT ( STDMETHODCALLTYPE *HandsOffStorage )( 
            __RPC__in IPersistStorage * This);

        END_INTERFACE
    } IPersistStorageVtbl;

    interface IPersistStorage
    {
        CONST_VTBL struct IPersistStorageVtbl *lpVtbl;
    };
</code></pre>
<p>而且在头文件能识别出个接口的IID，在IDA中标注出来，IDA也能自动帮我们完成这些工作。</p>
<pre><code class="c">typedef struct _GUID { 
    DWORD   Data1; 
    WORD    Data2; 
    WORD    Data3; 
    BYTE    Data4[8]; 
} GUID;
typedef GUID IID;
typedef IID* REFIID;
</code></pre>
<img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/CLSIDs.png">
<h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>我们知道CVE-2017-11882和之前的漏洞一样，也是在IPersistStorage::Load()中出了问题，我们使用CFlags附加调试EQNEDT32.exe，在该函数下断点开始分析，利用栈回溯的方法执行到弹出计算器。查看调用栈如图：<br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/call_stack.png"><br>整理出过程中关键的几个函数IPersistStorage::Load()中通过CExposedStream::Read()，分两次分别读入了EQNOLEFILEHDR和MTEFData，并在sub_42F8FF函数中处理MTEFData数据：<br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/step1.png"></p>
<p>处理MTEFData会进入sub_43755C，该函数主要是循环读入record，根据record tag处理record content，当record tag=0x8(即读到FONT tag时)会进入sub_43A720,在这个函数中循环使用setjmp实现，和平常不同：<br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/step2.png"></p>
<p>之后会进入到sub_43B418，该函数会读取fontName到指针lpLogFont。<br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/step3.png"><br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/step4.png"></p>
<p>最终在sub_41160F中，进行字符串拷贝时造成了栈溢出，变量&amp;v12=ebp-2Ch，超过这个值时就会造成栈溢出了。<br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/step5.png"></p>
<h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><p>在动态调试的过程中，我们能清楚看到程序对结构体的处理，当我们手头没有一份公开的结构体说明的时候，比较好的办法就是构造一个样本，提取其中的结构体。如果能从网上找到一些解释说明，对我们来说当然更好，这里有一份<a href="http://rtf2latex2e.sourceforge.net/MTEF3.html" target="_blank" rel="noopener">MTEF3格式</a>和<a href="http://www.cnblogs.com/netexplore/archive/2011/07/17/2108577.html" target="_blank" rel="noopener">RTF格式</a>的解释说明就直接拿来用了。<br>在实际漏洞挖掘中，漏洞分析本身就是构造POC的过程，通过分析我们知道漏洞主要问题出在对文档中Equation Native Stream Data的处理，Equation Native Stream Data = EQNOLEFILEHDR + MTEFData，其中MTEFData = MTEFHead + MTEF Byte Stream。参考一份正常样本，假设我们要触发EQNEDT32.EXE中的漏洞，构造出EQNIKEFUKEHDR必须满足：</p>
<pre><code class="c">struct EQNOLEFILEHDR {
   WORD    cbHdr;     // 格式头长度，固定为0x1C。
   DWORD   version;   // 固定为0x00020000。
   WORD    cf;        // 该公式对象的剪贴板格式。
   DWORD   cbObject;  // MTEF数据的长度，不包括头部。
   DWORD   reserved1; // 未公开
   DWORD   reserved2; // 未公开
   DWORD   reserved3; // 未公开
   DWORD   reserved4; // 未公开
};
</code></pre>
<p>同时我们知道问题具体是在MTEFByte中对FONT RECORD的处理，那就可以直接从正常样本中提取MTEF HEAD：</p>
<table>
<thead>
<tr>
<th style="text-align:left">偏移量</th>
<th style="text-align:left">说明</th>
<th style="text-align:left">构造样本值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">MTEF版本号</td>
<td style="text-align:left">0x03</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">该数据的生成系统</td>
<td style="text-align:left">0x01 表示Windows系统</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">该数据的生成产品</td>
<td style="text-align:left">0x01 表示有公式编辑器生成</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">产品主版本号</td>
<td style="text-align:left">0x03</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">产品子版本号</td>
<td style="text-align:left">0x0A</td>
</tr>
</tbody>
</table>
<p>然后是对MTEF Byte Stream的构造，我们要满足下面的条件，并且为了触发漏洞，我们要构造FONT Record:<br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/tag.png"><br>参考下图有MTEF Byte Stream = SIZE record + LINE record + FONT record(tag + typeface + style + name)。<br><img src="/2018/漏洞分析一百篇-05-WindowsOLE应用程序EQBEDT32上栈溢出漏洞/font_record.png"></p>
<p>之后就是很熟悉的一个过程了，对于完全没有缓解措施的应用程序，大家应该是信手拈来了，直接覆盖返回值，这里比较巧的是call WinEXE地址是0x00430c12，地址小端的写法刚好是字符串结尾。在winEXE中调用的参数，就是fontName。<br></p>
<h3 id="Metasploit框架"><a href="#Metasploit框架" class="headerlink" title="Metasploit框架"></a>Metasploit框架</h3><p>长期没有写Ruby了，手生练一练。构造EXP时候主要解决一个问题就是如何扩展到metesploit的payload模块，我们的想法就是通过webclient服务，让靶机下载payload然后利用powershell执行payload。<br>在exploit模块中利用到了powershell和http模块，这里做两点笔记：</p>
<ol>
<li>primer接口，参考<a href="https://blog.rapid7.com/2012/12/17/metasploit-hooks/" target="_blank" rel="noopener">https://blog.rapid7.com/2012/12/17/metasploit-hooks/</a></li>
<li>利用regsvr32 scrobj.dll，执行powershell脚本，参考<a href="https://betanews.com/2016/04/25/bypass-applocker-security/" target="_blank" rel="noopener">https://betanews.com/2016/04/25/bypass-applocker-security/</a></li>
</ol>
<p>在github提供完整的[EXP]<a href="https://github.com/leo00000/pwn/blob/master/CVE-2017-11882/msf_CVE_2017_11882.rb" target="_blank" rel="noopener">msf_CVE_2017_11882.rb</a>。</p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/漏洞分析一百篇-04-pingpongroot-WX利用/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.jpeg" alt="leo00000's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        leo3.14@foxmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/07/">七月 2018<span class="sidebar_archives-count">9</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">cloud_circle</i>
                
                标签云
            </a>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">9</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/leo00000" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/yang-xiao-niu-6-92-41/activities" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>leo00000的个人博客
            
                <br>
                
                    <a class="footer-develop-a" href="https://coding.net/pages " rel="nofollow" target="_blank">Hosted by Coding Pages</a>
                
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("sm_js","/js/smoothscroll.js?lOy/ACj5suSNi7ZVFVbpFQ==", true)</script>
    





    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>







<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
